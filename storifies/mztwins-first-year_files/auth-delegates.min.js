!function(e,t){"object"==typeof Livefyre&&"function"==typeof Livefyre.define&&Livefyre.define.amd?Livefyre.define([],t):"function"==typeof define&&define.amd&&define([],t);var r=t();e.Livefyre=e.Livefyre||{};for(var n in r)r.hasOwnProperty(n)&&(e.Livefyre[n]=r[n])}(this,function(){var e,t,r;return function(n){function o(e,t){return w.call(e,t)}function i(e,t){var r,n,o,i,s,a,u,l,c,f,p=t&&t.split("/"),h=m.map,d=h&&h["*"]||{};if(e&&"."===e.charAt(0))if(t){for(p=p.slice(0,p.length-1),e=p.concat(e.split("/")),l=0;l<e.length;l+=1)if(f=e[l],"."===f)e.splice(l,1),l-=1;else if(".."===f){if(1===l&&(".."===e[2]||".."===e[0]))break;l>0&&(e.splice(l-1,2),l-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((p||d)&&h){for(r=e.split("/"),l=r.length;l>0;l-=1){if(n=r.slice(0,l).join("/"),p)for(c=p.length;c>0;c-=1)if(o=h[p.slice(0,c).join("/")],o&&(o=o[n])){i=o,s=l;break}if(i)break;!a&&d&&d[n]&&(a=d[n],u=l)}!i&&a&&(i=a,s=u),i&&(r.splice(0,s,i),e=r.join("/"))}return e}function s(e,t){return function(){return h.apply(n,I.call(arguments,0).concat([e,t]))}}function a(e){return function(t){return i(t,e)}}function u(e){return function(t){v[e]=t}}function l(e){if(o(y,e)){var t=y[e];delete y[e],b[e]=!0,p.apply(n,t)}if(!o(v,e)&&!o(b,e))throw Error("No "+e);return v[e]}function c(e){var t,r=e?e.indexOf("!"):-1;return r>-1&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function f(e){return function(){return m&&m.config&&m.config[e]||{}}}var p,h,d,g,v={},y={},m={},b={},w=Object.prototype.hasOwnProperty,I=[].slice;d=function(e,t){var r,n=c(e),o=n[0];return e=n[1],o&&(o=i(o,t),r=l(o)),o?e=r&&r.normalize?r.normalize(e,a(t)):i(e,t):(e=i(e,t),n=c(e),o=n[0],e=n[1],o&&(r=l(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:r}},g={require:function(e){return s(e)},exports:function(e){var t=v[e];return void 0!==t?t:v[e]={}},module:function(e){return{id:e,uri:"",exports:v[e],config:f(e)}}},p=function(e,t,r,i){var a,c,f,p,h,m,w=[];if(i=i||e,"function"==typeof r){for(t=!t.length&&r.length?["require","exports","module"]:t,h=0;h<t.length;h+=1)if(p=d(t[h],i),c=p.f,"require"===c)w[h]=g.require(e);else if("exports"===c)w[h]=g.exports(e),m=!0;else if("module"===c)a=w[h]=g.module(e);else if(o(v,c)||o(y,c)||o(b,c))w[h]=l(c);else{if(!p.p)throw Error(e+" missing "+c);p.p.load(p.n,s(i,!0),u(c),{}),w[h]=v[c]}f=r.apply(v[e],w),e&&(a&&a.exports!==n&&a.exports!==v[e]?v[e]=a.exports:f===n&&m||(v[e]=f))}else e&&(v[e]=r)},e=t=h=function(e,t,r,o,i){return"string"==typeof e?g[e]?g[e](t):l(d(e,t).f):(e.splice||(m=e,t.splice?(e=t,t=r,r=null):e=n),t=t||function(){},"function"==typeof r&&(r=o,o=i),o?p(n,e,t,r):setTimeout(function(){p(n,e,t,r)},4),h)},h.config=function(e){return m=e,m.deps&&h(m.deps,m.callback),h},e._defined=v,r=function(e,t,r){t.splice||(r=t,t=[]),o(v,e)||o(y,e)||(y[e]=[e,t,r])},r.amd={jQuery:!0}}(),r("almond",function(){}),r("event-emitter",[],function(){function e(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var r=0,n=e.length;n>r;r++)if(e[r]===t)return r;return-1}var t=Array.prototype.slice,r=function(){this._listeners={}};return r.listenerCount=function(e,t){var r=e._listeners[t];return r?r.length:0},r.prototype.on=function(e,t){return this._listeners[e]=this._listeners[e]||[],this._listeners[e].push(t),this},r.prototype.addListener=r.prototype.on,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),t.apply(this,arguments)}return r.listener=t,this.on(e,r)},r.prototype.removeListener=function(t,r){r&&this._listeners[t]&&this._listeners[t].splice(e(this._listeners[t],r),1)},r.prototype.emit=function(e){var r,n=this._listeners[e]||[],o=t.call(arguments,1);if(n.length&&(n=n.slice()),"error"===e&&!n.length)throw r=o[0],r instanceof Error?r:TypeError('Uncaught, unspecified "error" event');for(var i=0,s=n.length;s>i;i++)try{n[i].apply(this,o)}catch(r){this.emit("error",r)}},r}),r("inherits",[],function(){function e(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}return e.parasitically=function(t,r){for(var n,o=e.keys(r.prototype),i=o.length,s=0;i>s;s++)n=o[s],t.prototype[n]||(t.prototype[n]=r.prototype[n])},e.keys=Object.keys||function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=r.length;return function(o){if("object"!=typeof o&&"function"!=typeof o||null===o)throw new TypeError("Object.keys called on a non-object");var i=[];for(var s in o)e.call(o,s)&&i.push(s);if(t)for(var a=0;n>a;a++)e.call(o,r[a])&&i.push(r[a]);return i}}(),e}),r("auth-delegates/util/jsonp",["require","exports","module"],function(e,t,r){function n(e,t){function r(){o.parentNode&&o.parentNode.removeChild(o),window[n]=void 0}var n="_lfcallback_"+ +new Date,o=document.createElement("script"),i=e.indexOf("?")>0?"&":"?";window[n]=function(e){r(),t(null,e)},o.type="text/javascript",o.async=!0,o.onerror=function(){r(),t("error")},o.src=e+i+"callback="+n,document.getElementsByTagName("head")[0].appendChild(o)}r.exports={req:n}}),r("auth-delegates/util/storage",["require","exports","module"],function(e,t,r){var n="__lfstorage__",o=function(){try{var e=localStorage||null;return e.setItem(n,"1"),e.removeItem(n),!0}catch(t){return!1}}(),i={set:function(e,t,r){var n={value:t,expiration:r||null};try{localStorage.setItem(e,JSON.stringify(n))}catch(o){}},get:function(e){try{var t=localStorage.getItem(e),r=t?JSON.parse(t):{};return r.expiration&&r.expiration<+new Date?(i.remove(e),void 0):r.value}catch(n){return void 0}},remove:function(e){try{localStorage.removeItem(e)}catch(t){}}},s={set:function(e,t,r){function n(e){return new Date(e).toUTCString()}var o,i,s=6048e5;o=r>0?n(r):0===r?";expires="+new Date(1970,1,1).toUTCString():+new Date+s,document.cookie=e+"="+JSON.stringify(t)+i},get:function(e){function t(){return document.cookie.split(/\s*;\s*/)}for(var r,n=e+"=",o=t(),i=0;r=o[i];++i){if(0===r.lastIndexOf(n,0))return r.substr(n.length);if(r===e)return""}return void 0},remove:function(e){s.set(e,"",0)}};r.exports=o?i:s}),r("auth-delegates/util/url",["require","exports","module"],function(e,t,r){var n={};n.getBaseUrl=function(e,t){var r=e.replace(/^https?:\/\//,"").replace(/^(admin|www)\./,"");return/livefyre|localhost|fyre$/.test(r)?/livefyre/.test(r)&&(r="www."+r):r=r.split(".")[0]+".admin.fyre.co",[t||window.location.protocol,"//",r].join("")},r.exports=n}),r("auth-delegates/user",["require","exports","module","event-emitter","inherits","auth-delegates/util/jsonp","auth-delegates/util/storage","auth-delegates/util/url"],function(e,t,r){function n(){this._attributes=n.getDefaults(),o.call(this)}var o=e("event-emitter"),i=e("inherits"),s=e("auth-delegates/util/jsonp"),a=e("auth-delegates/util/storage"),u=e("auth-delegates/util/url"),l="fyre-auth",c="fyre-authentication-creds";i(n,o),n.getDefaults=function(){return{modMap:{},keys:[]}},n.EVENTS={CHANGE:"change",LOGOUT:"logout",LOGIN:"login",LOGIN_REQUESTED:"loginRequested"},n.prototype.set=function(e,t){var r,o,i;"string"==typeof e&&(r=e,e={},e[r]=t);for(o in e)e.hasOwnProperty(o)&&(i=e[o],this._attributes[o]=i,this.emit(n.EVENTS.CHANGE+":"+o,i));this.emit(n.EVENTS.CHANGE,e)},n.prototype.get=function(e){return e?this._attributes[e]:this._attributes},n.prototype.unset=function(e){if(e in this._attributes){delete this._attributes[e];var t={};t[e]=void 0,this.emit(n.EVENTS.CHANGE+":"+e,t[e])}},n.prototype.logout=n.prototype.reset=function(){this._attributes={},this.set(n.getDefaults()),a.remove(l),a.remove(c),this.emit(n.EVENTS.LOGOUT)},n.prototype.login=function(e){this.set("token",e),this.emit(n.EVENTS.LOGIN_REQUESTED,e)},n.prototype.loadSession=function(e,t){var r=e.profile,o=e.permissions,i=o.authors,s=o.moderator_key,a=e.mod_map,u=e.token,l=[s],c=this.get("keys"),f=e.collection_id;r.token=u.value;for(var p=0;p<i.length;p++)l.push(i[p].key);this.set(r),this.set("keys",c.concat(l)),a&&this.set("modMap",a);var h=this.get("modMap");t&&s&&(h[t]=s),f&&s&&(h[f]=s),this.set("modMap",h),this.emit(n.EVENTS.LOGIN,e)},n.prototype.isAuthenticated=function(){return!!this.get("id")},n.prototype.isMod=function(e){return e in this.get("modMap")},n.prototype.remoteLogin=function(e){var t=u.getBaseUrl(e.serverUrl||"http://livefyre.com"),r="articleId="+encodeURIComponent(e.articleId)+"&siteId="+e.siteId,n=t+"/api/v3.0/auth/?"+r,o=this,i=this.get("token"),f=this.get("bpChannel");n+=i?"&lftoken="+encodeURIComponent(i):"",n+=f?"&bp_channel="+encodeURIComponent(f):"",s.req(n,function(t,r){if(!(t||r.data&&!r.data.profile)){var n=r.data,i=n.token,s=+new Date+1e3*i.ttl;o.loadSession(n,e.articleId),n.mod_map=o.get("modMap"),a.set(l,n,s);var u=n.auth_token;u&&a.set(c,u.value,+new Date+1e3*u.ttl),e.callback&&e.callback(n)}})},window.Livefyre=window.Livefyre||{},window.Livefyre.user=window.Livefyre.user||new n,r.exports=window.Livefyre.user}),r("base64",["require","exports","module"],function(e,t,r){function n(e){this.message=e}var o={},i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=Error(),n.prototype.name="InvalidCharacterError",o.btoa=window.btoa?function(e){return window.btoa(e)}:function(e){for(var t,r,o=0,s=i,a="";e.charAt(0|o)||(s="=",o%1);a+=s.charAt(63&t>>8-8*(o%1))){if(r=e.charCodeAt(o+=.75),r>255)throw new n("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|r}return a},o.atob=window.atob?function(e){return window.atob(e)}:function(e){if(e=e.replace(/=+$/,""),1==e.length%4)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,r,o=0,s=0,a="";r=e.charAt(s++);~r&&(t=o%4?64*t+r:r,o++%4)?a+=String.fromCharCode(255&t>>(6&-2*o)):0)r=i.indexOf(r);return a},r.exports=o}),r("auth-delegates/delegates/base",["require","exports","module","auth-delegates/user"],function(e,t,r){function n(){}var o=e("auth-delegates/user");n.prototype._user=o,n.prototype.getUser=function(){return this._user},n.prototype.setUser=function(e){this._user=e},n.prototype.restoreSession=function(){},n.prototype.viewProfile=function(){},n.prototype.editProfile=function(){},n.prototype.login=function(){},n.prototype.logout=function(){},n.prototype.destroy=function(){},r.exports=n}),r("auth-delegates/util/bind",["require","exports","module"],function(e,t,r){r.exports=function(e,t){if(!e)throw Error();if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}}),function(e){function t(e,t){var r=(65535&e)+(65535&t),n=(e>>16)+(t>>16)+(r>>16);return n<<16|65535&r}function n(e,t){return e<<t|e>>>32-t}function o(e,r,o,i,s,a){return t(n(t(t(r,e),t(i,a)),s),o)}function i(e,t,r,n,i,s,a){return o(t&r|~t&n,e,t,i,s,a)}function s(e,t,r,n,i,s,a){return o(t&n|r&~n,e,t,i,s,a)}function a(e,t,r,n,i,s,a){return o(t^r^n,e,t,i,s,a)}function u(e,t,r,n,i,s,a){return o(r^(t|~n),e,t,i,s,a)}function l(e,r){e[r>>5]|=128<<r%32,e[(r+64>>>9<<4)+14]=r;var n,o,l,c,f,p=1732584193,h=-271733879,d=-1732584194,g=271733878;for(n=0;n<e.length;n+=16)o=p,l=h,c=d,f=g,p=i(p,h,d,g,e[n],7,-680876936),g=i(g,p,h,d,e[n+1],12,-389564586),d=i(d,g,p,h,e[n+2],17,606105819),h=i(h,d,g,p,e[n+3],22,-1044525330),p=i(p,h,d,g,e[n+4],7,-176418897),g=i(g,p,h,d,e[n+5],12,1200080426),d=i(d,g,p,h,e[n+6],17,-1473231341),h=i(h,d,g,p,e[n+7],22,-45705983),p=i(p,h,d,g,e[n+8],7,1770035416),g=i(g,p,h,d,e[n+9],12,-1958414417),d=i(d,g,p,h,e[n+10],17,-42063),h=i(h,d,g,p,e[n+11],22,-1990404162),p=i(p,h,d,g,e[n+12],7,1804603682),g=i(g,p,h,d,e[n+13],12,-40341101),d=i(d,g,p,h,e[n+14],17,-1502002290),h=i(h,d,g,p,e[n+15],22,1236535329),p=s(p,h,d,g,e[n+1],5,-165796510),g=s(g,p,h,d,e[n+6],9,-1069501632),d=s(d,g,p,h,e[n+11],14,643717713),h=s(h,d,g,p,e[n],20,-373897302),p=s(p,h,d,g,e[n+5],5,-701558691),g=s(g,p,h,d,e[n+10],9,38016083),d=s(d,g,p,h,e[n+15],14,-660478335),h=s(h,d,g,p,e[n+4],20,-405537848),p=s(p,h,d,g,e[n+9],5,568446438),g=s(g,p,h,d,e[n+14],9,-1019803690),d=s(d,g,p,h,e[n+3],14,-187363961),h=s(h,d,g,p,e[n+8],20,1163531501),p=s(p,h,d,g,e[n+13],5,-1444681467),g=s(g,p,h,d,e[n+2],9,-51403784),d=s(d,g,p,h,e[n+7],14,1735328473),h=s(h,d,g,p,e[n+12],20,-1926607734),p=a(p,h,d,g,e[n+5],4,-378558),g=a(g,p,h,d,e[n+8],11,-2022574463),d=a(d,g,p,h,e[n+11],16,1839030562),h=a(h,d,g,p,e[n+14],23,-35309556),p=a(p,h,d,g,e[n+1],4,-1530992060),g=a(g,p,h,d,e[n+4],11,1272893353),d=a(d,g,p,h,e[n+7],16,-155497632),h=a(h,d,g,p,e[n+10],23,-1094730640),p=a(p,h,d,g,e[n+13],4,681279174),g=a(g,p,h,d,e[n],11,-358537222),d=a(d,g,p,h,e[n+3],16,-722521979),h=a(h,d,g,p,e[n+6],23,76029189),p=a(p,h,d,g,e[n+9],4,-640364487),g=a(g,p,h,d,e[n+12],11,-421815835),d=a(d,g,p,h,e[n+15],16,530742520),h=a(h,d,g,p,e[n+2],23,-995338651),p=u(p,h,d,g,e[n],6,-198630844),g=u(g,p,h,d,e[n+7],10,1126891415),d=u(d,g,p,h,e[n+14],15,-1416354905),h=u(h,d,g,p,e[n+5],21,-57434055),p=u(p,h,d,g,e[n+12],6,1700485571),g=u(g,p,h,d,e[n+3],10,-1894986606),d=u(d,g,p,h,e[n+10],15,-1051523),h=u(h,d,g,p,e[n+1],21,-2054922799),p=u(p,h,d,g,e[n+8],6,1873313359),g=u(g,p,h,d,e[n+15],10,-30611744),d=u(d,g,p,h,e[n+6],15,-1560198380),h=u(h,d,g,p,e[n+13],21,1309151649),p=u(p,h,d,g,e[n+4],6,-145523070),g=u(g,p,h,d,e[n+11],10,-1120210379),d=u(d,g,p,h,e[n+2],15,718787259),h=u(h,d,g,p,e[n+9],21,-343485551),p=t(p,o),h=t(h,l),d=t(d,c),g=t(g,f);return[p,h,d,g]}function c(e){var t,r="";for(t=0;t<32*e.length;t+=8)r+=String.fromCharCode(255&e[t>>5]>>>t%32);return r}function f(e){var t,r=[];for(r[(e.length>>2)-1]=void 0,t=0;t<r.length;t+=1)r[t]=0;for(t=0;t<8*e.length;t+=8)r[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return r}function p(e){return c(l(f(e),8*e.length))}function h(e,t){var r,n,o=f(e),i=[],s=[];for(i[15]=s[15]=void 0,o.length>16&&(o=l(o,8*e.length)),r=0;16>r;r+=1)i[r]=909522486^o[r],s[r]=1549556828^o[r];return n=l(i.concat(f(t)),512+8*t.length),c(l(s.concat(n),640))}function d(e){var t,r,n="0123456789abcdef",o="";for(r=0;r<e.length;r+=1)t=e.charCodeAt(r),o+=n.charAt(15&t>>>4)+n.charAt(15&t);return o}function g(e){return unescape(encodeURIComponent(e))}function v(e){return p(g(e))}function y(e){return d(v(e))}function m(e,t){return h(g(e),g(t))}function b(e,t){return d(m(e,t))}function w(e,t,r){return t?r?m(t,e):b(t,e):r?v(e):y(e)}"function"==typeof r&&r.amd?r("md5",[],function(){return w}):e.md5=w}(this),r("auth-delegates/delegates/backplane",["require","exports","module","base64","auth-delegates/delegates/base","auth-delegates/util/bind","inherits","auth-delegates/util/jsonp","md5","auth-delegates/util/storage","auth-delegates/user"],function(e,t,r){function n(e){for(var t,r,n=e.length;n--;)if(t=e[n],r=t.type||(t.message||{}).type,r===y.LOGIN||r===y.LOGOUT)return t;return null}function o(e,t){function r(e){g.set(m,o),t(e)}var o=window.Backplane.getChannelID()||null;e.subscribe(r),p.req(o,function(e,t){if(!e&&t.length){var o=n(t);o&&r(o.message)}})}function i(e,t){function r(e){g.set(m,e.messageURL),t(e)}e.subscribe(r);var o=e.getCachedMessages();if(o.length){var i=n(o);i&&r(i)}}function s(e,t){var r=e.version;if(b.v12.test(r))return o(e,t);if(b.v20.test(r))return i(e,t);throw"Backplane delegate is only compatible with version 1.2 and 2.0 of Backplane"}function a(e,t,r){if(!window.Backplane)throw"backplane instance must exist";this.articleId=u.btoa(e),this.siteId=t,this.serverUrl=r;var n=window.Backplane,o=this,i=!1,a=function(){o.currentBPChannel=n.getChannelID()||null,s(n,c(o.handleBackplaneMessage,o)),i=!0};n(function(){i||a()}),l.call(this)}var u=e("base64"),l=e("auth-delegates/delegates/base"),c=e("auth-delegates/util/bind"),f=e("inherits"),p=e("auth-delegates/util/jsonp"),h=e("md5"),d=e("auth-delegates/util/storage"),g=e("auth-delegates/user"),v="fyre-backplane-cache",y={LOGIN:"identity/login",LOGOUT:"identity/logout"},m="bpChannel",b={v12:/1\.2\.[0-9]/,v20:/2\.0\.[0-9]/},w={has:function(e){var t=e.messageURL||g.get(m),r=h(JSON.stringify(e)),n=d.get(v);return n&&t===n.channel&&r===n.checksum},set:function(e){var t=e.messageURL||g.get(m),r=h(JSON.stringify(e));d.set(v,{channel:t,checksum:r})},remove:function(){d.remove(v)}};f(a,l),a.prototype.handleBackplaneMessage=function(e){var t=e.type;switch(t){case y.LOGIN:if(w.has(e)){this.restoreSession();break}w.set(e),g.remoteLogin({siteId:this.siteId,articleId:this.articleId,serverUrl:this.serverUrl});break;case y.LOGOUT:g.logout();break;default:throw"This Backplane message type is not supported: "+t}},a.prototype.logout=function(){function e(){var o=n.backplane.getChannelID(),i=o&&n.currentBPChannel!==o;return clearTimeout(t),i||50===r?(w.remove(),n.currentBPChannel=n.backplane.getChannelID(),void 0):(t=setTimeout(e,100),void 0)}var t,r=0,n=this;e(),g.logout()},a.prototype.destroy=function(){this.articleId=this.siteId=this.serverUrl=this.currentBPChannel=null},r.exports=a}),r("auth-delegates/util/useragent",["require","exports","module"],function(e,t,r){var n=navigator.userAgent.toLowerCase(),o=/(iphone|ipod|blackberry|android|palm|windows\s+ce)/.test(n),i=/(windows|linux|os\s+[x9]|solaris|bsd)/.test(n),s=/(spider|crawl|slurp|bot)/.test(n);r.exports={isMobile:o||!s||!i}}),r("auth-delegates/delegates/lfsp",["require","exports","module","base64","auth-delegates/delegates/base","inherits","../user","../util/useragent"],function(e,t,r){function n(e,t,r,n){this.articleId=o.btoa(e),this.siteId=t,this.serverUrl=n;var s=r||{},u=this.spObject=window.fyre.sp;this.engageApp=new u.app.Engage(s.engageOpts||{}),this.profileApp=new u.app.Profile(s.profileOpts||{}),u.on(l.LOGIN_COMPLETE,function(e){a.login(e.token),a.remoteLogin({articleId:this.articleId,siteId:this.siteId,serverUrl:this.serverUrl})},this),u.on(l.LOGOUT_COMPLETE,function(){a.logout()},this),i.call(this)}var o=e("base64"),i=e("auth-delegates/delegates/base"),s=e("inherits"),a=e("../user"),u=e("../util/useragent"),l={LOGIN_COMPLETE:"auth_login_complete",LOGOUT_COMPLETE:"auth_logout_complete",ENGAGE_AUTH_CLOSE:"engage_auth_close"};s(n,i),n.prototype.login=function(){function e(r){a.login(r.token),this.spObject.off(l.LOGIN_COMPLETE,e),this.spObject.off(l.ENGAGE_AUTH_CLOSE,t)}function t(){this.spObject.off(l.ENGAGE_AUTH_CLOSE,t),this.spObject.off(l.LOGIN_COMPLETE,e)}this.engageApp.signIn(),this.spObject.on(l.LOGIN_COMPLETE,e,this),this.spObject.on(l.ENGAGE_AUTH_CLOSE,t,this)},n.prototype.logout=function(){this.engageApp.signOut()},n.prototype.viewProfile=function(e){var t,r;if(e.isCuratedAuthor){if(r=e.profileUrl,!r)return;return u.isMobile?(location.href=r,void 0):(window.open(e.profileUrl,"authWindow","location=true;menubar=false;resizable=false;scrollbars=false"),void 0)}e.id!==a.id&&(t=e.id.split("@")[0]),this.profileApp.viewProfile(t)},n.prototype.editProfile=function(){this.profileApp.editProfile()},n.prototype.destroy=function(){this.spObject.off(null,null,this),this.articleId=this.siteId=this.serverUrl=this.profileApp=this.engageApp=null},r.exports=n}),r("auth-delegates/delegates/livefyre",["require","exports","module","base64","auth-delegates/delegates/base","auth-delegates/util/bind","inherits","auth-delegates/util/jsonp","auth-delegates/util/storage","auth-delegates/user","auth-delegates/util/url"],function(e,t,r){function n(e,t,r){this.articleId=o.btoa(e),this.siteId=t,this.serverUrl=p.getBaseUrl(r||""),c.on("loginRequested",s(this.fetchAuthData,this)),i.call(this)}var o=e("base64"),i=e("auth-delegates/delegates/base"),s=e("auth-delegates/util/bind"),a=e("inherits"),u=e("auth-delegates/util/jsonp"),l=e("auth-delegates/util/storage"),c=e("auth-delegates/user"),f=navigator.userAgent,p=e("auth-delegates/util/url"),h="fyre-auth",d=f.indexOf("Opera")>-1;a(n,i),n.prototype.login=function(){this._popup()},n.prototype.fetchAuthData=function(){c.get("token")||c.remoteLogin({articleId:this.articleId,siteId:this.siteId,serverUrl:this.serverUrl})},n.prototype._popup=function(e){function t(e){if(!e)return!1;try{return e.closed===!1}catch(t){if(d)return!0;throw t}}function r(e,r){return t(r)?void 0:(clearInterval(u),c.remoteLogin({articleId:o,siteId:i,serverUrl:n}),void 0)}var n=this.serverUrl,o=this.articleId,i=this.siteId,s=n+"/auth/popup/login/?articleId="+o+"&siteId="+i,a=window.open(s,"authWindow","width=530;height=365;location=true;menubar=false;resizable=false;scrollbars=false"),u=setInterval(function(){r(e,a)},100)},n.prototype.logout=function(){var e=this.serverUrl+"/auth/logout/ajax/?nocache="+(new Date).getTime();u.req(e,function(e){e||c.logout()})},n.prototype.viewProfile=function(e){window.open(e.profileUrl,"_blank")},n.prototype.editProfile=function(){window.open(this.serverUrl+"/profile/edit/info/","_blank")},n.prototype.restoreSession=function(){var e=l.get(h)||{};e.token?c.loadSession(e,this.articleId):l.remove(h)},n.prototype.destroy=function(){this.articleId=this.siteId=this.serverUrl=null,c.removeListener("loginRequested",s(this.fetchAuthData,this))},r.exports=n}),r("auth-delegates/delegates/remote",["require","exports","module","base64","auth-delegates/delegates/base","auth-delegates/util/bind","inherits","auth-delegates/util/storage","auth-delegates/user"],function(e,t,r){function n(e,t,r){this.articleId=o.btoa(e),this.siteId=t,this.serverUrl=r,l.on("loginRequested",s(this.fetchAuthData,this)),i.call(this)}var o=e("base64"),i=e("auth-delegates/delegates/base"),s=e("auth-delegates/util/bind"),a=e("inherits"),u=e("auth-delegates/util/storage"),l=e("auth-delegates/user"),c="fyre-auth",f="fyre-authentication-creds";a(n,i),n.prototype.fetchAuthData=function(){this.restoreSession(),l.isAuthenticated()||l.remoteLogin({articleId:this.articleId,siteId:this.siteId,serverUrl:this.serverUrl})},n.prototype.logout=function(){l.logout()},n.prototype.viewProfile=function(e){e.profileUrl&&window.open(e.profileUrl,"_blank")},n.prototype.restoreSession=function(){var e=u.get(c)||{},t=u.get(f)||"",r=l.get("token");e.token&&t===r?l.loadSession(e):u.remove(c)},n.prototype.destroy=function(){l.removeListener("loginRequested",s(this.fetchAuthData,this))},r.exports=n}),r("auth-delegates/main",["require","exports","module","auth-delegates/user","auth-delegates/delegates/backplane","auth-delegates/delegates/lfsp","auth-delegates/delegates/livefyre","auth-delegates/delegates/remote"],function(e,t,r){r.exports={user:e("auth-delegates/user"),authDelegates:{Backplane:e("auth-delegates/delegates/backplane"),Lfsp:e("auth-delegates/delegates/lfsp"),Livefyre:e("auth-delegates/delegates/livefyre"),Remote:e("auth-delegates/delegates/remote")}}}),r("auth-delegates",["auth-delegates/main"],function(e){return e}),t("auth-delegates")});
//# sourceMappingURL=auth-delegates.min.js.map